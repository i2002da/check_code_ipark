# 📋 내역 코드 체크 시스템

건설 내역서의 코드를 자재리스트·일위대가리스트와 검토하고, 표준내역과 항목을 비교하는 웹 도구입니다.  
**서버 없이** 브라우저에서만 동작합니다 — 파일은 외부로 전송되지 않습니다.

## 🚀 GitHub Pages 배포 방법

1. 이 저장소를 **Fork** 하거나 새 저장소를 만들고 `index.html`을 업로드합니다.
2. **Settings → Pages → Source** 에서 `main` 브랜치, `/ (root)` 폴더를 선택합니다.
3. 저장 후 `https://[username].github.io/[repo-name]/` 으로 접속합니다.

## 📁 파일 구성

```
index.html   ← 전체 앱 (이 파일 하나로 완성)
README.md    ← 이 문서
```

## 🛠 사용 방법

### 코드 검토 실행

| 업로드 파일 | 설명 |
|---|---|
| 🔵 **원내역** | 검토 대상 원내역 파일 (필수) |
| 🟢 **자재리스트** | 자재 코드 DB 파일 |
| 🟡 **일위대가리스트** | 일위대가 코드 DB 파일 |

원내역 + 자재리스트/일위대가리스트를 업로드한 뒤 **▶ 코드 검토 실행** 클릭

#### 결과 분류
- ✅ **일치** — DB와 코드·품명·규격·단위 모두 일치
- ⚠ **코드상이** — 코드는 DB에 있으나 품명·규격·단위 중 하나 이상 다름 (차이 항목은 주황색 강조)
- ❌ **DB없음** — 원내역 코드가 자재리스트·일위대가리스트 어디에도 없음

---

### 표준내역 비교

| 업로드 파일 | 설명 |
|---|---|
| 🔵 **원내역** | 검토 대상 원내역 파일 (필수) |
| 🟣 **표준내역** | 비교 대상 표준내역 파일 (필수) |

원내역 + 표준내역을 업로드한 뒤 **⇄ 표준내역 비교** 클릭

#### 결과 분류
- ⚡ **원내역에만 존재** — 원내역에는 있으나 표준내역에 없는 항목
- 📎 **표준내역에만 존재** — 표준내역에는 있으나 원내역에 없는 항목
- ✅ **양쪽 모두 존재** — 두 내역 모두에 코드가 있는 항목

---

## 📥 결과 저장

**⬇ 결과 저장** 버튼으로 `.xlsx` 파일로 다운로드.  
코드 검토와 표준내역 비교를 모두 실행했다면 두 시트가 함께 저장됩니다.

## 🔧 지원 파일 형식

- `.xlsx` (Excel 2007+)
- `.xlsm` (매크로 포함 Excel)
- `.xls` (구 Excel)

## 📌 시트 인식 규칙

| 파일 | 자동 인식 시트 |
|---|---|
| 원내역 | `원내역`, `내역`, `Sheet1` (순서대로 탐색) |
| 자재리스트 | `자재리스트` 우선, 나머지 시트 순차 탐색 |
| 일위대가리스트 | `일위대가리스트` 우선, 나머지 시트 순차 탐색 |
| 표준내역 | `표준내역` 우선, 나머지 시트 순차 탐색 |

헤더 행(`코드`, `품명`, `규격`, `단위`)은 자동 탐색됩니다.  
`자재리스트`의 `품      명` 처럼 공백이 포함된 헤더도 자동 처리됩니다.

## 🌐 외부 의존성

| 라이브러리 | 용도 | CDN |
|---|---|---|
| [SheetJS (xlsx)](https://sheetjs.com) v0.18.5 | Excel 파일 읽기·쓰기 | cdnjs.cloudflare.com (fallback: unpkg.com) |
| [Noto Sans KR](https://fonts.google.com/noto/specimen/Noto+Sans+KR) | 한글 폰트 | fonts.googleapis.com (오프라인 시 시스템 폰트로 대체) |

> 인터넷 연결 없이도 SheetJS CDN 대신 `unpkg` fallback이 작동합니다.  
> 완전 오프라인 환경에서는 SheetJS 파일을 직접 다운로드해 `<script src="xlsx.full.min.js">` 로 교체하세요.

## 📄 License

MIT
