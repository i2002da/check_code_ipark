<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë‚´ì—­ ì½”ë“œ ì²´í¬ ì‹œìŠ¤í…œ</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;700&display=swap');

  :root {
    --bg: #0d0f14;
    --surface: #141820;
    --surface2: #1c2230;
    --border: #252d3d;
    --accent: #3b82f6;
    --accent2: #22d3ee;
    --warn: #f59e0b;
    --danger: #ef4444;
    --success: #10b981;
    --purple: #a855f7;
    --text: #e2e8f0;
    --text-dim: #64748b;
    --text-muted: #94a3b8;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'Noto Sans KR', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(59,130,246,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(59,130,246,0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none;
    z-index: 0;
  }

  .container { max-width: 1700px; margin: 0 auto; padding: 24px; position: relative; z-index: 1; }

  header {
    display: flex; align-items: center; gap: 14px;
    margin-bottom: 28px; padding-bottom: 20px;
    border-bottom: 1px solid var(--border);
  }
  .logo {
    width: 42px; height: 42px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
    font-size: 20px; flex-shrink: 0;
  }
  h1 { font-size: 20px; font-weight: 700; letter-spacing: -0.5px; }
  h1 span { color: var(--accent); }
  .subtitle { font-size: 11px; color: var(--text-dim); margin-top: 2px; font-family: 'JetBrains Mono', monospace; }

  /* Upload grid */
  .upload-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 12px;
    margin-bottom: 20px;
  }

  .upload-card {
    background: var(--surface);
    border: 1.5px dashed var(--border);
    border-radius: 10px;
    padding: 16px 14px;
    cursor: pointer;
    position: relative;
    transition: border-color 0.2s, background 0.2s;
  }
  .upload-card:hover, .upload-card.drag-over {
    border-color: var(--accent);
    background: rgba(59,130,246,0.05);
  }
  .upload-card.loaded { border-style: solid; }
  .upload-card.c-blue   { border-color: var(--accent); }
  .upload-card.c-green  { border-color: var(--success); }
  .upload-card.c-warn   { border-color: var(--warn); }
  .upload-card.c-purple { border-color: var(--purple); }

  .upload-card input[type="file"] {
    position: absolute; inset: 0; opacity: 0; cursor: pointer; width: 100%; height: 100%;
  }

  .uc-head { display: flex; align-items: center; gap: 7px; margin-bottom: 5px; }
  .uc-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
  .d-blue   { background: var(--accent); }
  .d-green  { background: var(--success); }
  .d-warn   { background: var(--warn); }
  .d-purple { background: var(--purple); }
  .uc-label { font-size: 12px; font-weight: 700; }

  .uc-badge {
    margin-left: auto;
    padding: 2px 7px; border-radius: 10px;
    font-size: 10px; font-weight: 600;
  }
  .req  { background: rgba(239,68,68,0.15); color: var(--danger); }
  .opt  { background: rgba(100,116,139,0.12); color: var(--text-dim); }

  .uc-desc { font-size: 11px; color: var(--text-dim); margin-bottom: 8px; }
  .uc-fn {
    font-size: 11px; color: var(--text-dim);
    font-family: 'JetBrains Mono', monospace;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  }
  .uc-fn.ok { color: var(--success); }

  /* Action bar */
  .action-bar {
    display: flex; align-items: center; gap: 10px;
    margin-bottom: 20px; flex-wrap: wrap;
  }
  .vsep { width: 1px; height: 28px; background: var(--border); }

  .btn {
    padding: 9px 18px; border-radius: 8px;
    font-size: 13px; font-weight: 600;
    font-family: 'Noto Sans KR', sans-serif;
    border: none; cursor: pointer;
    transition: all 0.15s;
    display: flex; align-items: center; gap: 6px;
    white-space: nowrap;
  }
  .btn:disabled { opacity: 0.35; cursor: not-allowed; transform: none !important; }

  .btn-blue   { background: var(--accent);  color: white; }
  .btn-blue:not(:disabled):hover   { background: #2563eb; transform: translateY(-1px); }
  .btn-purple { background: var(--purple);  color: white; }
  .btn-purple:not(:disabled):hover { background: #9333ea; transform: translateY(-1px); }
  .btn-outline {
    background: transparent; color: var(--text-muted);
    border: 1px solid var(--border);
  }
  .btn-outline:not(:disabled):hover { border-color: var(--accent); color: var(--accent); }

  /* Mode tabs */
  .mode-tabs {
    display: flex; gap: 0;
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 10px; padding: 4px;
    width: fit-content; margin-bottom: 16px;
  }
  .mode-tab {
    padding: 7px 18px; border-radius: 7px;
    font-size: 12px; font-weight: 600;
    font-family: 'Noto Sans KR', sans-serif;
    border: none; cursor: pointer;
    background: transparent; color: var(--text-dim);
    transition: all 0.15s;
  }
  .tab-blue   { background: var(--accent); color: white; }
  .tab-purple { background: var(--purple); color: white; }

  /* Stats */
  .stats-bar { display: flex; gap: 10px; margin-bottom: 16px; flex-wrap: wrap; }
  .stat-card {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 8px; padding: 10px 14px; min-width: 110px;
  }
  .stat-label { font-size: 10px; color: var(--text-dim); margin-bottom: 4px; letter-spacing: 0.5px; text-transform: uppercase; }
  .stat-val { font-size: 22px; font-weight: 700; font-family: 'JetBrains Mono', monospace; }
  .v-blue   { color: var(--accent); }
  .v-green  { color: var(--success); }
  .v-yellow { color: var(--warn); }
  .v-red    { color: var(--danger); }
  .v-cyan   { color: var(--accent2); }
  .v-purple { color: var(--purple); }

  /* Filter bar */
  .filter-bar {
    display: flex; gap: 8px; margin-bottom: 12px;
    flex-wrap: wrap; align-items: center;
  }
  .fbtn {
    padding: 5px 12px; border-radius: 20px;
    font-size: 11px; font-weight: 600;
    font-family: 'Noto Sans KR', sans-serif;
    border: 1px solid var(--border);
    background: transparent; color: var(--text-muted);
    cursor: pointer; transition: all 0.15s;
  }
  .fbtn:hover { border-color: var(--accent); color: var(--accent); }
  .fa-all    { background: var(--accent);   border-color: var(--accent);   color: white; }
  .fa-ok     { background: var(--success);  border-color: var(--success);  color: white; }
  .fa-diff   { background: var(--warn);     border-color: var(--warn);     color: white; }
  .fa-miss   { background: var(--danger);   border-color: var(--danger);   color: white; }
  .fa-nocode { background: var(--text-dim); border-color: var(--text-dim); color: white; }
  .fa-only1  { background: var(--accent);   border-color: var(--accent);   color: white; }
  .fa-only2  { background: var(--purple);   border-color: var(--purple);   color: white; }
  .fa-both   { background: var(--success);  border-color: var(--success);  color: white; }

  .search-input {
    padding: 5px 12px; background: var(--surface);
    border: 1px solid var(--border); border-radius: 8px;
    color: var(--text); font-size: 12px;
    font-family: 'Noto Sans KR', sans-serif;
    width: 200px; outline: none; margin-left: auto;
  }
  .search-input:focus { border-color: var(--accent); }

  /* Hint box */
  .hint-box {
    background: rgba(168,85,247,0.06); border: 1px solid rgba(168,85,247,0.2);
    border-radius: 8px; padding: 10px 14px;
    font-size: 11px; color: var(--text-muted);
    margin-bottom: 12px; line-height: 1.8;
  }
  .hint-box b { color: var(--purple); }

  /* Table */
  .table-wrapper {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 10px; overflow: hidden;
  }
  .table-scroll { max-height: 60vh; overflow-y: auto; }
  .table-scroll::-webkit-scrollbar { width: 5px; }
  .table-scroll::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

  table { width: 100%; border-collapse: collapse; font-size: 12px; }
  thead tr { background: var(--surface2); }
  th {
    padding: 9px 12px; text-align: left;
    font-size: 10px; font-weight: 700; color: var(--text-dim);
    letter-spacing: 0.6px; text-transform: uppercase; white-space: nowrap;
    position: sticky; top: 0; background: var(--surface2); z-index: 10;
    border-bottom: 1px solid var(--border);
  }
  tbody tr { border-bottom: 1px solid rgba(37,45,61,0.5); transition: background 0.1s; }
  tbody tr:hover { background: rgba(59,130,246,0.04); }
  tbody tr:last-child { border-bottom: none; }
  td { padding: 8px 12px; vertical-align: middle; }

  .tc   { font-family: 'JetBrains Mono', monospace; font-size: 11px; color: var(--accent2); white-space: nowrap; }
  .tn   { font-weight: 500; }
  .ts   { color: var(--text-muted); font-size: 11px; }
  .tu   { color: var(--text-dim); font-size: 11px; text-align: center; }
  .tr   { color: var(--text-dim); font-size: 10px; font-family: 'JetBrains Mono', monospace; text-align: center; }
  .hl   { color: var(--warn); }

  tr.sec-row td {
    background: rgba(59,130,246,0.07);
    color: var(--accent); font-weight: 700; font-size: 11px;
    border-bottom: 1px solid rgba(59,130,246,0.15);
  }

  .badge {
    display: inline-flex; align-items: center; gap: 3px;
    padding: 2px 8px; border-radius: 4px;
    font-size: 10px; font-weight: 700; white-space: nowrap;
  }
  .bk  { background: rgba(16,185,129,0.15);  color: var(--success); }
  .bd  { background: rgba(245,158,11,0.15);   color: var(--warn); }
  .bm  { background: rgba(239,68,68,0.15);    color: var(--danger); }
  .bn  { background: rgba(100,116,139,0.1);   color: var(--text-muted); }
  .b1  { background: rgba(59,130,246,0.15);   color: var(--accent); }
  .b2  { background: rgba(168,85,247,0.15);   color: var(--purple); }
  .bb  { background: rgba(16,185,129,0.15);   color: var(--success); }

  .loading {
    display: flex; align-items: center; justify-content: center;
    padding: 60px; gap: 12px; color: var(--text-dim); font-size: 14px;
  }
  .spin {
    width: 18px; height: 18px;
    border: 2px solid var(--border); border-top-color: var(--accent);
    border-radius: 50%; animation: spin 0.7s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  .empty {
    padding: 70px; text-align: center; color: var(--text-dim);
  }
  .empty .ico { font-size: 42px; margin-bottom: 12px; }
  .empty p { font-size: 13px; line-height: 1.9; }
</style>
</head>
<body>
<div class="container">

  <header>
    <div class="logo">ğŸ“‹</div>
    <div>
      <h1>ë‚´ì—­ ì½”ë“œ <span>ì²´í¬ ì‹œìŠ¤í…œ</span></h1>
      <div class="subtitle">ì›ë‚´ì—­ â†” ìì¬ë¦¬ìŠ¤íŠ¸Â·ì¼ìœ„ëŒ€ê°€ë¦¬ìŠ¤íŠ¸ ì½”ë“œê²€í†  / í‘œì¤€ë‚´ì—­ í•­ëª© ë¹„êµ</div>
    </div>
  </header>

  <!-- Upload -->
  <div class="upload-grid">

    <div class="upload-card" id="drop0">
      <input type="file" id="file0" accept=".xlsx,.xlsm,.xls">
      <div class="uc-head">
        <div class="uc-dot d-blue"></div>
        <div class="uc-label">ì›ë‚´ì—­</div>
        <span class="uc-badge req">í•„ìˆ˜</span>
      </div>
      <div class="uc-desc">ê²€í†  ëŒ€ìƒ ì›ë‚´ì—­ íŒŒì¼</div>
      <div class="uc-fn" id="fn0">íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë¡­í•˜ì„¸ìš”</div>
    </div>

    <div class="upload-card" id="drop1">
      <input type="file" id="file1" accept=".xlsx,.xlsm,.xls">
      <div class="uc-head">
        <div class="uc-dot d-green"></div>
        <div class="uc-label">ìì¬ë¦¬ìŠ¤íŠ¸</div>
        <span class="uc-badge req">ì½”ë“œê²€í† </span>
      </div>
      <div class="uc-desc">ìì¬ ì½”ë“œ DB íŒŒì¼</div>
      <div class="uc-fn" id="fn1">íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë¡­í•˜ì„¸ìš”</div>
    </div>

    <div class="upload-card" id="drop2">
      <input type="file" id="file2" accept=".xlsx,.xlsm,.xls">
      <div class="uc-head">
        <div class="uc-dot d-warn"></div>
        <div class="uc-label">ì¼ìœ„ëŒ€ê°€ë¦¬ìŠ¤íŠ¸</div>
        <span class="uc-badge req">ì½”ë“œê²€í† </span>
      </div>
      <div class="uc-desc">ì¼ìœ„ëŒ€ê°€ ì½”ë“œ DB íŒŒì¼</div>
      <div class="uc-fn" id="fn2">íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë¡­í•˜ì„¸ìš”</div>
    </div>

    <div class="upload-card" id="drop3">
      <input type="file" id="file3" accept=".xlsx,.xlsm,.xls">
      <div class="uc-head">
        <div class="uc-dot d-purple"></div>
        <div class="uc-label">í‘œì¤€ë‚´ì—­</div>
        <span class="uc-badge opt">í‘œì¤€ë‚´ì—­ë¹„êµ</span>
      </div>
      <div class="uc-desc">í‘œì¤€ë‚´ì—­ ë¹„êµ íŒŒì¼</div>
      <div class="uc-fn" id="fn3">íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë¡­í•˜ì„¸ìš”</div>
    </div>

  </div>

  <!-- Actions -->
  <div class="action-bar">
    <button class="btn btn-blue"   id="btnCode"   disabled onclick="runCodeCheck()">â–¶ ì½”ë“œ ê²€í†  ì‹¤í–‰</button>
    <button class="btn btn-purple" id="btnStd"    disabled onclick="runStdCheck()">â‡„ í‘œì¤€ë‚´ì—­ ë¹„êµ</button>
    <div class="vsep"></div>
    <button class="btn btn-outline" id="btnExport" disabled onclick="exportResult()">â¬‡ ê²°ê³¼ ì €ì¥</button>
    <button class="btn btn-outline" onclick="resetAll()">â†º ì´ˆê¸°í™”</button>
  </div>

  <!-- Mode tabs -->
  <div id="modeTabs" style="display:none" class="mode-tabs">
    <button class="mode-tab" id="tabCode" onclick="switchTab('code')">ğŸ“Œ ì½”ë“œ ê²€í†  ê²°ê³¼</button>
    <button class="mode-tab" id="tabStd"  onclick="switchTab('std')">ğŸ“Š í‘œì¤€ë‚´ì—­ ë¹„êµ ê²°ê³¼</button>
  </div>

  <!-- Stats -->
  <div id="statsArea"></div>

  <!-- Filter -->
  <div id="filterArea"></div>

  <!-- Hint -->
  <div id="hintArea"></div>

  <!-- Table -->
  <div class="table-wrapper">
    <div class="table-scroll" id="tableWrap">
      <div class="empty">
        <div class="ico">ğŸ“‹</div>
        <p>ì›ë‚´ì—­ + ìì¬ë¦¬ìŠ¤íŠ¸/ì¼ìœ„ëŒ€ê°€ë¦¬ìŠ¤íŠ¸ë¥¼ ì—…ë¡œë“œ í›„<br><b>ì½”ë“œ ê²€í†  ì‹¤í–‰</b> í´ë¦­<br><br>
           í‘œì¤€ë‚´ì—­ê³¼ í•­ëª© ë¹„êµëŠ” í‘œì¤€ë‚´ì—­ë„ ì—…ë¡œë“œ í›„<br><b>í‘œì¤€ë‚´ì—­ ë¹„êµ</b> í´ë¦­</p>
      </div>
    </div>
  </div>

</div>
<script>
// â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const wbs = [null,null,null,null];
const dotCls = ['c-blue','c-green','c-warn','c-purple'];

let codeRes = [];
let stdRes  = [];
let curTab  = '';
let curFilter = 'all';
let curSearch = '';

// â”€â”€ File Drop Setup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0,1,2,3].forEach(i => {
  const inp  = document.getElementById('file'+i);
  const card = document.getElementById('drop'+i);
  const fnEl = document.getElementById('fn'+i);

  inp.addEventListener('change', e => { if(e.target.files[0]) loadWb(e.target.files[0],i,fnEl,card); });
  card.addEventListener('dragover', e => { e.preventDefault(); card.classList.add('drag-over'); });
  card.addEventListener('dragleave', () => card.classList.remove('drag-over'));
  card.addEventListener('drop', e => {
    e.preventDefault(); card.classList.remove('drag-over');
    if(e.dataTransfer.files[0]) loadWb(e.dataTransfer.files[0],i,fnEl,card);
  });
});

function loadWb(file, i, fnEl, card) {
  fnEl.textContent = 'ë¡œë”© ì¤‘...'; fnEl.className = 'uc-fn';
  const r = new FileReader();
  r.onload = e => {
    try {
      wbs[i] = XLSX.read(e.target.result, {type:'array'});
      fnEl.textContent = 'âœ“ '+file.name; fnEl.className = 'uc-fn ok';
      card.classList.add('loaded', dotCls[i]);
    } catch(err) { fnEl.textContent = 'âŒ '+err.message; }
    updateBtns();
  };
  r.readAsArrayBuffer(file);
}

function updateBtns() {
  document.getElementById('btnCode').disabled = !(wbs[0] && (wbs[1]||wbs[2]));
  document.getElementById('btnStd').disabled  = !(wbs[0] && wbs[3]);
}

// â”€â”€ Excel Utils â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function normH(s)    { return String(s||'').replace(/\s/g,''); }
function normSpec(s) { return String(s||'').replace(/\s/g,''); }
function esc(s) {
  return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

function sheetRows(wb, sn) {
  const sh = wb.Sheets[sn]; if(!sh) return null;
  return XLSX.utils.sheet_to_json(sh, {header:1, defval:''});
}

function findHdrRow(rows) {
  for(let i=0;i<Math.min(10,rows.length);i++)
    if(rows[i].some(c=>normH(c)==='ì½”ë“œ')) return i;
  return 2;
}

function colIdx(hdr) {
  return {
    ci: hdr.findIndex(c=>normH(c)==='ì½”ë“œ'),
    ni: hdr.findIndex(c=>normH(c)==='í’ˆëª…'),
    si: hdr.findIndex(c=>normH(c)==='ê·œê²©'),
    ui: hdr.findIndex(c=>normH(c)==='ë‹¨ìœ„'),
  };
}

// Build codeâ†’{name,spec,unit,src} map from a workbook
// preferSheets: try these first, then rest of SheetNames
function buildMap(wb, preferSheets) {
  const map = new Map();
  const tried = new Set();
  for(const sn of [...preferSheets, ...wb.SheetNames]) {
    if(tried.has(sn)) continue; tried.add(sn);
    const rows = sheetRows(wb, sn); if(!rows) continue;
    const hr = findHdrRow(rows);
    const {ci,ni,si,ui} = colIdx(rows[hr]);
    if(ci<0) continue;
    for(let r=hr+1; r<rows.length; r++) {
      const code = String(rows[r][ci]||'').trim();
      if(!code || /^[0-9]{1,2}$/.test(code)) continue;
      if(!map.has(code)) map.set(code, {
        name: ni>=0 ? String(rows[r][ni]||'').trim() : '',
        spec: si>=0 ? String(rows[r][si]||'').trim() : '',
        unit: ui>=0 ? String(rows[r][ui]||'').trim() : '',
        src:  sn,
      });
    }
  }
  return map;
}

// Parse ì›ë‚´ì—­ â†’ array of items
function parseSource(wb) {
  const snPri = ['ì›ë‚´ì—­','ë‚´ì—­','Sheet1'];
  const sn = snPri.find(s=>wb.SheetNames.includes(s)) || wb.SheetNames[0];
  const rows = sheetRows(wb, sn);
  if(!rows) throw new Error('ì›ë‚´ì—­ ì‹œíŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
  const hr = findHdrRow(rows);
  const {ci,ni,si,ui} = colIdx(rows[hr]);
  const out = [];
  for(let r=hr+1; r<rows.length; r++) {
    const code = String(rows[r][ci]||'').trim();
    if(!code) continue;
    if(/^[0-9]{1,2}$/.test(code)) {
      out.push({isSection:true, code, name:String(rows[r][ni]||'').trim()});
      continue;
    }
    out.push({
      isSection:false, row:r+1, code,
      name: ni>=0 ? String(rows[r][ni]||'').trim() : '',
      spec: si>=0 ? String(rows[r][si]||'').trim() : '',
      unit: ui>=0 ? String(rows[r][ui]||'').trim() : '',
    });
  }
  return out;
}

// â”€â”€ CODE CHECK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function runCodeCheck() {
  loading();
  setTimeout(()=>{
    try {
      // DB: ìì¬ë¦¬ìŠ¤íŠ¸(wbs[1]) + ì¼ìœ„ëŒ€ê°€ë¦¬ìŠ¤íŠ¸(wbs[2]) ë§Œ ì‚¬ìš©
      const dbMap = new Map();
      if(wbs[1]) buildMap(wbs[1],['ìì¬ë¦¬ìŠ¤íŠ¸']).forEach((v,k)=>{ if(!dbMap.has(k)) dbMap.set(k,v); });
      if(wbs[2]) buildMap(wbs[2],['ì¼ìœ„ëŒ€ê°€ë¦¬ìŠ¤íŠ¸']).forEach((v,k)=>{ if(!dbMap.has(k)) dbMap.set(k,v); });

      const items = parseSource(wbs[0]);
      codeRes = items.map(item=>{
        if(item.isSection) return item;
        const db = dbMap.get(item.code);
        if(!db) return {...item, status:'miss', db:null};

        const sS=normSpec(item.spec), dS=normSpec(db.spec);
        const sU=item.unit.trim(),    dU=(db.unit||'').trim();
        const sN=item.name.trim(),    dN=(db.name||'').trim();

        const sdiff = dS!==sS && (dS||sS);
        const udiff = dU!==sU && (dU||sU);
        const ndiff = dN!==sN && (dN||sN);

        return {...item, status:(sdiff||udiff||ndiff)?'diff':'ok', db, sdiff, udiff, ndiff};
      });

      curTab='code'; curFilter='all'; curSearch='';
      renderCode();
      showTabs();
      document.getElementById('btnExport').disabled=false;
    } catch(e){ errMsg(e.message); }
  },30);
}

function renderCode() {
  const f=curFilter, q=curSearch;
  const visible = codeRes.filter(r=>{
    if(r.isSection) return f==='all' && !q;
    if(q && !r.code.toLowerCase().includes(q) && !r.name.toLowerCase().includes(q)) return false;
    if(f==='all') return true;
    return r.status===f;
  });

  const items = codeRes.filter(r=>!r.isSection);
  const N  = items.length;
  const ok = items.filter(r=>r.status==='ok').length;
  const df = items.filter(r=>r.status==='diff').length;
  const ms = items.filter(r=>r.status==='miss').length;
  const nc = items.filter(r=>r.status==='nocode').length;

  setStats(`
    <div class="stats-bar">
      <div class="stat-card"><div class="stat-label">ì „ì²´</div><div class="stat-val v-blue">${N}</div></div>
      <div class="stat-card"><div class="stat-label">âœ… ì¼ì¹˜</div><div class="stat-val v-green">${ok}</div></div>
      <div class="stat-card"><div class="stat-label">âš  ì½”ë“œìƒì´</div><div class="stat-val v-yellow">${df}</div></div>
      <div class="stat-card"><div class="stat-label">âŒ DBì—†ìŒ</div><div class="stat-val v-red">${ms}</div></div>
      ${nc>0?`<div class="stat-card"><div class="stat-label">â€” ë¯¸í™•ì¸</div><div class="stat-val v-cyan">${nc}</div></div>`:''}
    </div>`);

  setFilter(`
    <button class="fbtn ${f==='all'?'fa-all':''}"    onclick="sf('all','code')">ì „ì²´ ${N}</button>
    <button class="fbtn ${f==='ok'?'fa-ok':''}"      onclick="sf('ok','code')">âœ… ì¼ì¹˜ ${ok}</button>
    <button class="fbtn ${f==='diff'?'fa-diff':''}"  onclick="sf('diff','code')">âš  ì½”ë“œìƒì´ ${df}</button>
    <button class="fbtn ${f==='miss'?'fa-miss':''}"  onclick="sf('miss','code')">âŒ DBì—†ìŒ ${ms}</button>
    ${nc>0?`<button class="fbtn ${f==='nocode'?'fa-nocode':''}" onclick="sf('nocode','code')">â€” ë¯¸í™•ì¸ ${nc}</button>`:''}
    <input class="search-input" id="si" placeholder="ì½”ë“œÂ·í’ˆëª… ê²€ìƒ‰..." value="${esc(q)}" oninput="ss(this.value,'code')">`);

  setHint('');

  if(!visible.length){ emptyMsg('ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ'); return; }

  let h=`<table><thead><tr>
    <th>í–‰</th><th>ì½”ë“œ</th><th>í’ˆëª… (ì›ë‚´ì—­)</th><th>ê·œê²© (ì›ë‚´ì—­)</th><th>ë‹¨ìœ„</th>
    <th>DB í’ˆëª…</th><th>DB ê·œê²©</th><th>DB ë‹¨ìœ„</th><th>ì¶œì²˜</th><th>ê²°ê³¼</th>
  </tr></thead><tbody>`;

  for(const r of visible){
    if(r.isSection){ h+=`<tr class="sec-row"><td colspan="10">â–¶ ${esc(r.name||r.code)}</td></tr>`; continue; }
    h+=`<tr>
      <td class="tr">${r.row}</td>
      <td class="tc">${esc(r.code)}</td>
      <td class="tn">${esc(r.name)}</td>
      <td class="ts">${esc(r.spec)}</td>
      <td class="tu">${esc(r.unit)}</td>
      <td class="ts ${r.ndiff?'hl':''}">${esc(r.db?.name||'')}</td>
      <td class="ts ${r.sdiff?'hl':''}">${esc(r.db?.spec||'')}</td>
      <td class="tu ${r.udiff?'hl':''}">${esc(r.db?.unit||'')}</td>
      <td class="ts" style="font-size:10px;color:var(--text-dim)">${esc(r.db?.src||'')}</td>
      <td>${codeBadge(r.status)}</td>
    </tr>`;
  }
  h+='</tbody></table>';
  document.getElementById('tableWrap').innerHTML=h;
}

function codeBadge(s){
  const m={ok:['bk','âœ“ ì¼ì¹˜'],diff:['bd','âš  ì½”ë“œìƒì´'],miss:['bm','âœ• DBì—†ìŒ'],nocode:['bn','â€” ë¯¸í™•ì¸']};
  const [c,l]=m[s]||['bn',s];
  return `<span class="badge ${c}">${l}</span>`;
}

// â”€â”€ STANDARD CHECK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function runStdCheck() {
  loading();
  setTimeout(()=>{
    try {
      // ì›ë‚´ì—­ ì „ì²´(ì„¹ì…˜ í¬í•¨) íŒŒì‹±
      const allSrc   = parseSource(wbs[0]);
      const wonItems = allSrc.filter(r=>!r.isSection);
      const wonCodes = new Set(wonItems.map(r=>r.code));

      // í‘œì¤€ë‚´ì—­ map
      const stdMap = buildMap(wbs[3], ['í‘œì¤€ë‚´ì—­']);

      // â”€â”€ ì›ë‚´ì—­ ê³µì¢… ì„¹ì…˜ êµ¬ì¡° íŒŒì•… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const sections = [];
      let curSec = null;
      for(const item of allSrc){
        if(item.isSection){
          curSec = { secCode:item.code, secName:item.name, wonItems:[], stdOnlyItems:[] };
          sections.push(curSec);
        } else {
          if(!curSec){
            curSec = { secCode:'', secName:'ê³µì¢…ë¯¸ë¶„ë¥˜', wonItems:[], stdOnlyItems:[] };
            sections.push(curSec);
          }
          curSec.wonItems.push(item);
        }
      }

      // â”€â”€ í‘œì¤€ë‚´ì—­ ì½”ë“œì— ê³µì¢… ë°°ì • â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      // í‘œì¤€ë‚´ì—­ íŒŒì¼ ì„¹ì…˜ ë§µ ìƒì„± (ì½”ë“œ â†’ ì„¹ì…˜ì½”ë“œ)
      const stdSecMap = buildStdSectionMap(wbs[3]);

      // í‘œì¤€ë‚´ì—­ì—ë§Œ ìˆëŠ” í•­ëª© â†’ ì›ë‚´ì—­ ì„¹ì…˜ì— ë°°ì •
      stdMap.forEach((v, code)=>{
        if(wonCodes.has(code)) return;

        const stdSecCode = stdSecMap.get(code) || '';
        let targetSec = sections.find(s=>s.secCode === stdSecCode);

        if(!targetSec){
          if(!sections.find(s=>s.secCode==='__only2__')){
            sections.push({ secCode:'__only2__', secName:'í‘œì¤€ë‚´ì—­ì—ë§Œ ì¡´ì¬', wonItems:[], stdOnlyItems:[] });
          }
          targetSec = sections.find(s=>s.secCode==='__only2__');
        }
        targetSec.stdOnlyItems.push({
          isSection:false, code, name:v.name, spec:v.spec, unit:v.unit,
          status:'only2', si:v
        });
      });

      // â”€â”€ stdRes ì¡°ë¦½: ì›ë‚´ì—­ ê³µì¢… ìˆœì„œ ê·¸ëŒ€ë¡œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      stdRes = [];
      for(const sec of sections){
        const hasContent = sec.wonItems.length > 0 || sec.stdOnlyItems.length > 0;
        if(!hasContent) continue;

        // ì„¹ì…˜ í—¤ë”
        if(sec.secCode === '__only2__'){
          stdRes.push({ isSection:true, code:'', name:'ğŸ“ í‘œì¤€ë‚´ì—­ì—ë§Œ ì¡´ì¬í•˜ëŠ” í•­ëª©' });
        } else if(sec.secCode){
          stdRes.push({ isSection:true, code:sec.secCode, name:sec.secName });
        }

        // ì›ë‚´ì—­ í•­ëª© (ì›ë‚´ì—­ ìˆœì„œ ìœ ì§€)
        for(const item of sec.wonItems){
          if(stdMap.has(item.code)){
            stdRes.push({...item, status:'both', si:stdMap.get(item.code)});
          } else {
            stdRes.push({...item, status:'only1'});
          }
        }

        // í•´ë‹¹ ê³µì¢…ì˜ í‘œì¤€ë‚´ì—­ only í•­ëª©
        for(const item of sec.stdOnlyItems){
          stdRes.push(item);
        }
      }

      curTab='std'; curFilter='all'; curSearch='';
      renderStd();
      showTabs();
      document.getElementById('btnExport').disabled=false;
    } catch(e){ errMsg(e.message); }
  },30);
}

// í‘œì¤€ë‚´ì—­ íŒŒì¼ì—ì„œ ì½”ë“œâ†’ì„¹ì…˜ì½”ë“œ ë§¤í•‘ ìƒì„±
function buildStdSectionMap(wb){
  const map = new Map();
  const snList = ['í‘œì¤€ë‚´ì—­', ...wb.SheetNames];
  const tried = new Set();
  for(const sn of snList){
    if(tried.has(sn)) continue; tried.add(sn);
    const rows = sheetRows(wb, sn); if(!rows) continue;
    const hr = findHdrRow(rows);
    const {ci} = colIdx(rows[hr]);
    if(ci<0) continue;
    let curSec = '';
    for(let r=hr+1; r<rows.length; r++){
      const code = String(rows[r][ci]||'').trim();
      if(!code) continue;
      if(/^[0-9]{1,2}$/.test(code)){ curSec=code; continue; }
      map.set(code, curSec);
    }
    break;
  }
  return map;
}

function renderStd(){
  const f=curFilter, q=curSearch;
  const only1 = stdRes.filter(r=>!r.isSection && r.status==='only1');
  const only2 = stdRes.filter(r=>!r.isSection && r.status==='only2');
  const both  = stdRes.filter(r=>!r.isSection && r.status==='both');

  const visible = stdRes.filter(r=>{
    // ì„¹ì…˜ í—¤ë”: í•„í„°ê°€ allì´ê³  ê²€ìƒ‰ì–´ ì—†ì„ ë•Œ, ë˜ëŠ” í•´ë‹¹ ì„¹ì…˜ ì•„ë˜ visible í•­ëª©ì´ ìˆì„ ë•Œ í‘œì‹œ
    if(r.isSection){
      if(q) return false; // ê²€ìƒ‰ ì¤‘ì—” ì„¹ì…˜ ìˆ¨ê¹€
      if(f==='all') return true;
      // í•„í„° í™œì„± ì‹œ: í•´ë‹¹ ì„¹ì…˜ì½”ë“œ ì•„ë˜ì— visible í•­ëª©ì´ ìˆëŠ”ì§€ í™•ì¸
      const secIdx = stdRes.indexOf(r);
      for(let i=secIdx+1; i<stdRes.length; i++){
        if(stdRes[i].isSection) break;
        if(stdRes[i].status===f) return true;
      }
      return false;
    }
    if(q && !r.code.toLowerCase().includes(q) && !r.name.toLowerCase().includes(q)) return false;
    if(f==='all') return true;
    return r.status===f;
  });

  setStats(`
    <div class="stats-bar">
      <div class="stat-card"><div class="stat-label">ì›ë‚´ì—­ í•­ëª© ìˆ˜</div><div class="stat-val v-blue">${only1.length+both.length}</div></div>
      <div class="stat-card"><div class="stat-label">í‘œì¤€ë‚´ì—­ í•­ëª© ìˆ˜</div><div class="stat-val v-purple">${only2.length+both.length}</div></div>
      <div class="stat-card"><div class="stat-label">âš¡ ì›ë‚´ì—­ì—ë§Œ ì¡´ì¬</div><div class="stat-val v-blue">${only1.length}</div></div>
      <div class="stat-card"><div class="stat-label">ğŸ“ í‘œì¤€ë‚´ì—­ì—ë§Œ ì¡´ì¬</div><div class="stat-val v-purple">${only2.length}</div></div>
      <div class="stat-card"><div class="stat-label">âœ… ì–‘ìª½ ëª¨ë‘ ì¡´ì¬</div><div class="stat-val v-green">${both.length}</div></div>
    </div>`);

  setFilter(`
    <button class="fbtn ${f==='all'?'fa-all':''}"    onclick="sf('all','std')">ì „ì²´ ${stdRes.length}</button>
    <button class="fbtn ${f==='only1'?'fa-only1':''}" onclick="sf('only1','std')">âš¡ ì›ë‚´ì—­ë§Œ ${only1.length}</button>
    <button class="fbtn ${f==='only2'?'fa-only2':''}" onclick="sf('only2','std')">ğŸ“ í‘œì¤€ë‚´ì—­ë§Œ ${only2.length}</button>
    <button class="fbtn ${f==='both'?'fa-both':''}"   onclick="sf('both','std')">âœ… ì–‘ìª½ ëª¨ë‘ ${both.length}</button>
    <input class="search-input" id="si" placeholder="ì½”ë“œÂ·í’ˆëª… ê²€ìƒ‰..." value="${esc(q)}" oninput="ss(this.value,'std')">`);

  setHint(`
    <b>âš¡ ì›ë‚´ì—­ë§Œ ì¡´ì¬</b> (${only1.length}ê±´): ì›ë‚´ì—­ì—ëŠ” ìˆìœ¼ë‚˜ í‘œì¤€ë‚´ì—­ì— ì—†ëŠ” í•­ëª© &nbsp;|&nbsp;
    <b>ğŸ“ í‘œì¤€ë‚´ì—­ë§Œ ì¡´ì¬</b> (${only2.length}ê±´): í‘œì¤€ë‚´ì—­ì—ëŠ” ìˆìœ¼ë‚˜ ì›ë‚´ì—­ì— ì—†ëŠ” í•­ëª© &nbsp;|&nbsp;
    <b>âœ… ì–‘ìª½ ëª¨ë‘</b> (${both.length}ê±´): ë‘ ë‚´ì—­ ëª¨ë‘ì— ì½”ë“œ ì¡´ì¬`);

  if(!visible.length){ emptyMsg('ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ'); return; }

  let h=`<table><thead><tr>
    <th>êµ¬ë¶„</th>
    <th>ì½”ë“œ</th>
    <th>ì›ë‚´ì—­ í’ˆëª…</th><th>ì›ë‚´ì—­ ê·œê²©</th><th>ì›ë‚´ì—­ ë‹¨ìœ„</th>
    <th>í‘œì¤€ë‚´ì—­ í’ˆëª…</th><th>í‘œì¤€ë‚´ì—­ ê·œê²©</th><th>í‘œì¤€ë‚´ì—­ ë‹¨ìœ„</th>
  </tr></thead><tbody>`;

  for(const r of visible){
    // ì„¹ì…˜ í—¤ë” í–‰
    if(r.isSection){
      const secLabel = r.code ? `[${esc(r.code)}] ${esc(r.name||r.code)}` : esc(r.name||'');
      h+=`<tr class="sec-row"><td colspan="8">â–¶ ${secLabel}</td></tr>`;
      continue;
    }
    const si = r.si||{};
    const isOnly2 = r.status==='only2';

    const wName = isOnly2 ? `<span style="color:var(--text-dim)">â€”</span>` : esc(r.name);
    const wSpec = isOnly2 ? `<span style="color:var(--text-dim)">â€”</span>` : esc(r.spec);
    const wUnit = isOnly2 ? `<span style="color:var(--text-dim)">â€”</span>` : esc(r.unit);
    const sColor = isOnly2 ? 'color:var(--purple)' : 'color:var(--text-muted)';

    h+=`<tr>
      <td>${stdBadge(r.status)}</td>
      <td class="tc">${esc(r.code)}</td>
      <td class="tn">${wName}</td>
      <td class="ts">${wSpec}</td>
      <td class="tu">${wUnit}</td>
      <td class="ts" style="${sColor}">${esc(si.name||'')}</td>
      <td class="ts" style="${sColor}">${esc(si.spec||'')}</td>
      <td class="tu" style="${sColor}">${esc(si.unit||'')}</td>
    </tr>`;
  }
  h+='</tbody></table>';
  document.getElementById('tableWrap').innerHTML=h;
}

function stdBadge(s){
  const m={only1:['b1','âš¡ ì›ë‚´ì—­ë§Œ'],only2:['b2','ğŸ“ í‘œì¤€ë‚´ì—­ë§Œ'],both:['bb','âœ… ì–‘ìª½']};
  const [c,l]=m[s]||['bn',s];
  return `<span class="badge ${c}">${l}</span>`;
}

// â”€â”€ Tabs / Filter / Search â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showTabs(){
  document.getElementById('modeTabs').style.display='flex';
  document.getElementById('tabCode').className = 'mode-tab'+(curTab==='code'?' tab-blue':'');
  document.getElementById('tabStd').className  = 'mode-tab'+(curTab==='std'?' tab-purple':'');
}

function switchTab(tab){
  curTab=tab; curFilter='all'; curSearch='';
  showTabs();
  if(tab==='code' && codeRes.length) renderCode();
  else if(tab==='std' && stdRes.length) renderStd();
}

function sf(f, mode){ curFilter=f; mode==='code'?renderCode():renderStd(); }
function ss(v, mode){ curSearch=v.toLowerCase(); mode==='code'?renderCode():renderStd(); }

// â”€â”€ Export â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function exportResult(){
  const wb = XLSX.utils.book_new();

  if(codeRes.length){
    const rows=[['í–‰','ì½”ë“œ','í’ˆëª…','ê·œê²©','ë‹¨ìœ„','DB í’ˆëª…','DB ê·œê²©','DB ë‹¨ìœ„','ì¶œì²˜','ê²°ê³¼']];
    const lbl={ok:'ì¼ì¹˜',diff:'ì½”ë“œìƒì´',miss:'í˜„ì¥ì½”ë“œ(DBì—†ìŒ)',nocode:'ë¯¸í™•ì¸'};
    for(const r of codeRes){
      if(r.isSection){ rows.push([`â–¶ ${r.name||r.code}`,'','','','','','','','','']); continue; }
      rows.push([r.row,r.code,r.name,r.spec,r.unit,r.db?.name||'',r.db?.spec||'',r.db?.unit||'',r.db?.src||'',lbl[r.status]||r.status]);
    }
    const ws=XLSX.utils.aoa_to_sheet(rows);
    ws['!cols']=[5,14,22,24,6,22,24,6,12,12].map(w=>({wch:w}));
    XLSX.utils.book_append_sheet(wb,ws,'ì½”ë“œê²€í† ê²°ê³¼');
  }

  if(stdRes.length){
    const rows=[['êµ¬ë¶„','ì½”ë“œ','ì›ë‚´ì—­ í’ˆëª…','ì›ë‚´ì—­ ê·œê²©','ì›ë‚´ì—­ ë‹¨ìœ„','í‘œì¤€ë‚´ì—­ í’ˆëª…','í‘œì¤€ë‚´ì—­ ê·œê²©','í‘œì¤€ë‚´ì—­ ë‹¨ìœ„']];
    const lbl={only1:'ì›ë‚´ì—­ë§Œ',only2:'í‘œì¤€ë‚´ì—­ë§Œ',both:'ì–‘ìª½ëª¨ë‘'};
    for(const r of stdRes){
      if(r.isSection){ rows.push([`â–¶ ${r.code?'['+r.code+'] ':''}${r.name||''}`,'','','','','','','']); continue; }
      const si=r.si||{};
      rows.push([lbl[r.status]||r.status,r.code,r.name||'',r.spec||'',r.unit||'',si.name||'',si.spec||'',si.unit||'']);
    }
    const ws=XLSX.utils.aoa_to_sheet(rows);
    ws['!cols']=[12,14,22,24,6,22,24,6].map(w=>({wch:w}));
    XLSX.utils.book_append_sheet(wb,ws,'í‘œì¤€ë‚´ì—­ë¹„êµê²°ê³¼');
  }

  if(!wb.SheetNames.length){ alert('ë‚´ë³´ë‚¼ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤'); return; }
  XLSX.writeFile(wb, `ì½”ë“œì²´í¬ê²°ê³¼_${new Date().toISOString().slice(0,10)}.xlsx`);
}

// â”€â”€ Reset â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function resetAll(){
  [0,1,2,3].forEach(i=>{
    wbs[i]=null;
    document.getElementById('fn'+i).textContent='íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë¡­í•˜ì„¸ìš”';
    document.getElementById('fn'+i).className='uc-fn';
    const c=document.getElementById('drop'+i);
    c.classList.remove('loaded','c-blue','c-green','c-warn','c-purple');
    document.getElementById('file'+i).value='';
  });
  codeRes=[]; stdRes=[]; curTab=''; curFilter='all'; curSearch='';
  updateBtns();
  document.getElementById('btnExport').disabled=true;
  document.getElementById('modeTabs').style.display='none';
  setStats(''); setFilter(''); setHint('');
  document.getElementById('tableWrap').innerHTML=
    `<div class="empty"><div class="ico">ğŸ“‹</div><p>ì›ë‚´ì—­ + ìì¬ë¦¬ìŠ¤íŠ¸/ì¼ìœ„ëŒ€ê°€ë¦¬ìŠ¤íŠ¸ë¥¼ ì—…ë¡œë“œ í›„<br><b>ì½”ë“œ ê²€í†  ì‹¤í–‰</b> í´ë¦­<br><br>í‘œì¤€ë‚´ì—­ í•­ëª© ë¹„êµëŠ” í‘œì¤€ë‚´ì—­ë„ ì—…ë¡œë“œ í›„<br><b>í‘œì¤€ë‚´ì—­ ë¹„êµ</b> í´ë¦­</p></div>`;
}

// â”€â”€ DOM helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function loading(){ document.getElementById('tableWrap').innerHTML='<div class="loading"><div class="spin"></div>ë¶„ì„ ì¤‘...</div>'; setStats(''); setFilter(''); setHint(''); }
function errMsg(m){ document.getElementById('tableWrap').innerHTML=`<div class="empty"><div class="ico">âŒ</div><p>ì˜¤ë¥˜: ${esc(m)}</p></div>`; }
function emptyMsg(m){ document.getElementById('tableWrap').innerHTML=`<div class="empty"><div class="ico">ğŸ”</div><p>${m}</p></div>`; }
function setStats(h){ document.getElementById('statsArea').innerHTML=h; }
function setFilter(h){ document.getElementById('filterArea').innerHTML=h; }
function setHint(h){
  const el=document.getElementById('hintArea');
  if(h){ el.className='hint-box'; el.innerHTML=h; }
  else { el.className=''; el.innerHTML=''; }
}
</script>
</body>
</html>
